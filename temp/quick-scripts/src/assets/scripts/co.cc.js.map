{"version":3,"sources":["assets\\scripts\\co.cc.js"],"names":["valueTypes_cc","require","AsyncFunctionType","GeneratorFunctionType","GeneratorType","PromiseType","objectToString","Object","prototype","toString","getType","value","call","isSupportedAsync","isSupportedAsyncType","type","CoroutineStop","coroutines","WeakSet","RUNNING","SUSPENDED","STOPPING","DONE","Coroutine","group","executor","status","stopped","finalResult","finalException","lastException","lastExceptionLog","executorStack","Array","currentExecutorStackIndex","pushExecutor","popExecutor","getActiveExecutor","stop","eType","resume","args","currentCoroutine","coroutine","isStopping","isStopped","suspend","onSuspend","isSuspended","onResume","isDone","execute","lastResult","currentExecutor","undefined","execResult","run","exception","console","error","errorToString","nextTick","result","nextExecutor","directlyValue","e","abort","toPublic","publicCoroutine","addCoroutine","add","isCoroutine","obj","has","getCurrentCoroutine","normal","belowNormal","lowest","aboveNormal","highest","CoroutineGroupPriority","Lowest","BelowNormal","Normal","AboveNormal","Highest","PROMISE_PENDING","PROMISE_FULFILLED","PROMISE_REJECTED","promiseToGenerator","promise","state","then","val","err","regeneratorRuntime","mark","_callee2","wrap","_callee2$","_context2","prev","next","abrupt","asyncFnToGenerator","asyncFn","coroutineToGenerator","_callee3","_callee3$","_context3","generatorExecutors","GeneratorExecutor","gen","done","coroutineGroups","CoroutineGroup","groupSet","name","options","_options$priority","hasByName","Error","priority","runtime","currentPriority","runningCoroutines","coroutinesData","Map","start","genFn","coroutineGroup","set","tickWhile","currentTickCount","push","stopAll","forEach","update","length","currentTick","idel","idelc","i","imax","get","splice","setPriority","updatePriority","publicCoroutineGroup","size","addCoroutineGroup","isCoroutineGroup","CoroutineGroupSet","groups","Set","nameToGroupMapping","groupUpdateOrderList","dirtyGroupUpdateOrder","groupName","getByName","sortUpdateOrder","flags","sort","a","b","Runtime","tickRate","autoTickEnabled","tickCount","tickTime","enableAutoTick","startTick","interval","Math","floor","schedule","window","tickIfNecessary","t1","t0","tick","requestAnimationFrame","Date","now","nextTime","t","setTimeout","currentTime","currentRuntime","manualTick","oldRuntime","publicRuntime","mainGroup","lastTickTime","performTick","getCurrentRuntime","asAsync","fn","_callee","self","cb","_callee$","_context","slice","apply","arguments","isObject","startStopwatch","time0","tick0","stopwatch","elapsedSeconds","elapsedMilliseconds","elapsedTicks","restart","startAll","caller","genFns","currentGroup","isArray","genFnIndex","keys","genFnName","_marked$7","waitForAll","waitForAll$","_marked$6","waitForAny","any","waitForAny$","_marked$5","waitForTime","time","elapsedTime","waitForTime$","_marked$4","waitForMilliseconds","milliseconds","waitForMilliseconds$","max","_marked$3","waitForSeconds","seconds","waitForSeconds$","_marked$2","waitForTicks","ticks","maxTicks","tickCnt","waitForTicks$","_marked$1","waitUntil","action","waitUntil$","_marked","waitWhile","waitWhile$","utils","freeze","__proto__","isGenerator","isGeneratorFunction","isAsyncFunction","isPromise","exportRuntime","startCoroutine","addProperty","getter","defineProperty","enumerable","configurable","getGroupByName","hasGroup","hasGroupByName","Reflect","ownKeys","priorityName","fnName","index","module","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["// @ts-nocheck\r\n'use strict';\r\n\r\nvar valueTypes_cc = require('./value-types.cc');\r\n\r\nconst AsyncFunctionType = '[object AsyncFunction]';\r\nconst GeneratorFunctionType = '[object GeneratorFunction]';\r\nconst GeneratorType = '[object Generator]';\r\nconst PromiseType = '[object Promise]';\r\nconst objectToString = Object.prototype.toString;\r\nfunction getType(value) {\r\n  return objectToString.call(value);\r\n}\r\nfunction isSupportedAsync(value) {\r\n  return isSupportedAsyncType(objectToString.call(value));\r\n}\r\nfunction isSupportedAsyncType(type) {\r\n  switch (type) {\r\n    case AsyncFunctionType:\r\n    case GeneratorFunctionType:\r\n    case GeneratorType:\r\n    case PromiseType:\r\n      return true;\r\n\r\n    default:\r\n      return false;\r\n  }\r\n}\r\n\r\nfunction CoroutineStop() {}\r\n\r\nconst coroutines = new WeakSet();\r\nconst RUNNING = 0;\r\nconst SUSPENDED = 1;\r\nconst STOPPING = 2;\r\nconst DONE = 3;\r\nfunction Coroutine(group, executor) {\r\n  // const runtime = group.groupSet.runtime;\r\n  let status = RUNNING;\r\n  let stopped = false;\r\n  let finalResult, finalException;\r\n  let lastException, lastExceptionLog; // const lastYield = {};\r\n\r\n  const executorStack = new Array(24); // prealloc...\r\n\r\n  let currentExecutorStackIndex = -1;\r\n\r\n  const pushExecutor = executor => {\r\n    // executor.tick0 = runtime.currentTickCount;\r\n    executorStack[++currentExecutorStackIndex] = executor;\r\n    return executor;\r\n  };\r\n\r\n  const popExecutor = () => {\r\n    if (currentExecutorStackIndex >= 0) {\r\n      --currentExecutorStackIndex;\r\n      return getActiveExecutor();\r\n    }\r\n  };\r\n\r\n  const getActiveExecutor = () => {\r\n    if (currentExecutorStackIndex >= 0) {\r\n      return executorStack[currentExecutorStackIndex];\r\n    }\r\n  }; // const setLastYield = ticks => {\r\n  //   lastYield.ticks = ticks;\r\n  // };\r\n\r\n\r\n  const stop = (eType = CoroutineStop, ...args) => {\r\n    resume();\r\n\r\n    if (status === RUNNING) {\r\n      status = STOPPING;\r\n\r\n      if (currentCoroutine === coroutine) {\r\n        throw new eType(...args);\r\n      }\r\n\r\n      lastException = new eType(...args);\r\n    }\r\n  };\r\n\r\n  const isStopping = () => status === STOPPING;\r\n\r\n  const isStopped = () => stopped;\r\n\r\n  const suspend = () => {\r\n    if (status === RUNNING) {\r\n      status = SUSPENDED;\r\n      group.onSuspend(coroutine);\r\n    }\r\n  };\r\n\r\n  const isSuspended = () => status === SUSPENDED;\r\n\r\n  const resume = () => {\r\n    if (status === SUSPENDED) {\r\n      status = RUNNING;\r\n      group.onResume(coroutine);\r\n    }\r\n  };\r\n\r\n  const isDone = () => status === DONE;\r\n\r\n  const execute = () => {\r\n    if (status !== RUNNING && status !== STOPPING) {\r\n      return;\r\n    }\r\n\r\n    currentCoroutine = coroutine;\r\n    let lastResult;\r\n\r\n    try {\r\n      let currentExecutor = getActiveExecutor();\r\n\r\n      while (true) {\r\n        if (currentExecutor === undefined) {\r\n          if (status === STOPPING) {\r\n            stopped = true; // lastException = undefined;\r\n          }\r\n\r\n          status = DONE;\r\n          break;\r\n        }\r\n\r\n        const execResult = currentExecutor.run(lastException, lastResult);\r\n        lastException = execResult.exception;\r\n\r\n        if (lastException !== lastExceptionLog) {\r\n          lastExceptionLog = lastException;\r\n\r\n          if (lastExceptionLog !== undefined && !(lastExceptionLog instanceof CoroutineStop)) {\r\n            console.error(`[co.Coroutine] runtime error: ${valueTypes_cc.errorToString(lastExceptionLog)}`);\r\n          }\r\n        }\r\n\r\n        if (execResult.nextTick === true) {\r\n          // setLastYield(1);\r\n          break;\r\n        }\r\n\r\n        lastResult = execResult.result;\r\n\r\n        if (execResult.nextExecutor !== undefined) {\r\n          currentExecutor = pushExecutor(execResult.nextExecutor); // setLastYield(0);\r\n\r\n          continue;\r\n        }\r\n\r\n        if (execResult.directlyValue === true) {\r\n          // setLastYield(0);\r\n          continue;\r\n        } // setLastYield(runtime.currentTickCount - currentExecutor.tick0);\r\n\r\n\r\n        currentExecutor = popExecutor();\r\n      }\r\n    } catch (e) {\r\n      console.error(`[co.Coroutine] internal error: ${valueTypes_cc.errorToString(e)}`);\r\n    }\r\n\r\n    if (status === DONE) {\r\n      let executor = getActiveExecutor();\r\n\r\n      while (executor !== undefined) {\r\n        executor.abort();\r\n        executor = popExecutor();\r\n      } // executorStack.splice(0);\r\n\r\n\r\n      finalException = lastException;\r\n      finalResult = lastResult;\r\n    }\r\n\r\n    currentCoroutine = null;\r\n  };\r\n\r\n  const toPublic = (() => {\r\n    const publicCoroutine = {\r\n      get group() {\r\n        return group.toPublic();\r\n      },\r\n\r\n      get result() {\r\n        return finalResult;\r\n      },\r\n\r\n      get exception() {\r\n        return finalException;\r\n      },\r\n\r\n      // get lastYield() {\r\n      //   return { ...lastYield };\r\n      // },\r\n      stop,\r\n      isStopping,\r\n      isStopped,\r\n      suspend,\r\n      isSuspended,\r\n      resume,\r\n      isDone\r\n    };\r\n    return () => publicCoroutine;\r\n  })(); // setLastYield(0);\r\n\r\n\r\n  pushExecutor(executor);\r\n  const coroutine = {\r\n    // properties\r\n    get group() {\r\n      return group;\r\n    },\r\n\r\n    get result() {\r\n      return finalResult;\r\n    },\r\n\r\n    get exception() {\r\n      return finalException;\r\n    },\r\n\r\n    // methods\r\n    stop,\r\n    isStopping,\r\n    isStopped,\r\n    suspend,\r\n    isSuspended,\r\n    resume,\r\n    isDone,\r\n    execute,\r\n    toPublic\r\n  };\r\n  return addCoroutine(coroutine);\r\n}\r\n\r\nfunction addCoroutine(coroutine) {\r\n  coroutines.add(coroutine);\r\n  coroutines.add(coroutine.toPublic());\r\n  return coroutine;\r\n}\r\n\r\nfunction isCoroutine(obj) {\r\n  return coroutines.has(obj);\r\n}\r\nlet currentCoroutine = null;\r\nfunction getCurrentCoroutine() {\r\n  return currentCoroutine;\r\n}\r\n\r\nconst normal = 0;\r\nconst belowNormal = normal - 10000000;\r\nconst lowest = belowNormal - 10000000;\r\nconst aboveNormal = normal + 10000000;\r\nconst highest = aboveNormal + 10000000;\r\nvar CoroutineGroupPriority = {\r\n  get Lowest() {\r\n    return lowest;\r\n  },\r\n\r\n  get BelowNormal() {\r\n    return belowNormal;\r\n  },\r\n\r\n  get Normal() {\r\n    return normal;\r\n  },\r\n\r\n  get AboveNormal() {\r\n    return aboveNormal;\r\n  },\r\n\r\n  get Highest() {\r\n    return highest;\r\n  }\r\n\r\n};\r\n\r\nconst PROMISE_PENDING = 0;\r\nconst PROMISE_FULFILLED = 1;\r\nconst PROMISE_REJECTED = 2;\r\nfunction promiseToGenerator(promise) {\r\n  let state = PROMISE_PENDING;\r\n  let value;\r\n  promise.then(val => {\r\n    state = PROMISE_FULFILLED;\r\n    value = val;\r\n  }, err => {\r\n    state = PROMISE_REJECTED;\r\n    value = err;\r\n  });\r\n  return /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\r\n    return regeneratorRuntime.wrap(function _callee2$(_context2) {\r\n      while (1) switch (_context2.prev = _context2.next) {\r\n        case 0:\r\n\r\n          if (!(state !== PROMISE_PENDING)) {\r\n            _context2.next = 5;\r\n            break;\r\n          }\r\n\r\n          if (!(state === PROMISE_REJECTED)) {\r\n            _context2.next = 4;\r\n            break;\r\n          }\r\n\r\n          throw value;\r\n\r\n        case 4:\r\n          return _context2.abrupt(\"return\", value);\r\n\r\n        case 5:\r\n          _context2.next = 7;\r\n          return;\r\n\r\n        case 7:\r\n          _context2.next = 0;\r\n          break;\r\n\r\n        case 9:\r\n        case \"end\":\r\n          return _context2.stop();\r\n      }\r\n    }, _callee2);\r\n  })();\r\n}\r\nfunction asyncFnToGenerator(asyncFn) {\r\n  // Async Function returns Promise\r\n  return promiseToGenerator(asyncFn());\r\n}\r\nfunction coroutineToGenerator(coroutine) {\r\n  return /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\r\n    return regeneratorRuntime.wrap(function _callee3$(_context3) {\r\n      while (1) switch (_context3.prev = _context3.next) {\r\n        case 0:\r\n\r\n          if (!coroutine.isDone()) {\r\n            _context3.next = 5;\r\n            break;\r\n          }\r\n\r\n          if (!(coroutine.exception !== undefined)) {\r\n            _context3.next = 4;\r\n            break;\r\n          }\r\n\r\n          throw coroutine.exception;\r\n\r\n        case 4:\r\n          return _context3.abrupt(\"return\", coroutine.result);\r\n\r\n        case 5:\r\n          _context3.next = 7;\r\n          return;\r\n\r\n        case 7:\r\n          _context3.next = 0;\r\n          break;\r\n\r\n        case 9:\r\n        case \"end\":\r\n          return _context3.stop();\r\n      }\r\n    }, _callee3);\r\n  })();\r\n}\r\n\r\nconst generatorExecutors = new WeakSet();\r\nfunction GeneratorExecutor(gen) {\r\n  const executor = {\r\n    run(exception, result) {\r\n      const execResult = {};\r\n      let state;\r\n\r\n      try {\r\n        state = exception !== undefined ? gen.throw(exception) : gen.next(result);\r\n      } catch (e) {\r\n        execResult.exception = e;\r\n        state = {\r\n          done: true\r\n        };\r\n      }\r\n\r\n      if (state.done) {\r\n        execResult.result = state.value;\r\n      } else {\r\n        const value = state.value;\r\n\r\n        if (value === undefined) {\r\n          execResult.nextTick = true;\r\n        } else if (generatorExecutors.has(value)) {\r\n          execResult.nextExecutor = value;\r\n        } else if (isCoroutine(value)) {\r\n          execResult.nextExecutor = GeneratorExecutor(coroutineToGenerator(value));\r\n        } else {\r\n          switch (getType(value)) {\r\n            case GeneratorFunctionType:\r\n              execResult.nextExecutor = GeneratorExecutor(value());\r\n              break;\r\n\r\n            case GeneratorType:\r\n              execResult.nextExecutor = GeneratorExecutor(value);\r\n              break;\r\n\r\n            case PromiseType:\r\n              execResult.nextExecutor = GeneratorExecutor(promiseToGenerator(value));\r\n              break;\r\n\r\n            case AsyncFunctionType:\r\n              execResult.nextExecutor = GeneratorExecutor(asyncFnToGenerator(value));\r\n              break;\r\n\r\n            default:\r\n              // nextExecutor = GeneratorExecutor(anyToGenerator(value));\r\n              execResult.result = value;\r\n              execResult.directlyValue = true;\r\n              break;\r\n          }\r\n        }\r\n      }\r\n\r\n      return execResult;\r\n    },\r\n\r\n    abort() {\r\n      try {\r\n        gen.return();\r\n      } catch {}\r\n    }\r\n\r\n  };\r\n  generatorExecutors.add(executor);\r\n  return executor;\r\n}\r\n\r\nconst coroutineGroups = new WeakSet();\r\nfunction CoroutineGroup(groupSet, name, options = {}) {\r\n  var _options$priority;\r\n\r\n  if (groupSet.hasByName(name)) {\r\n    throw new Error(`coroutine group '${name}' exists`);\r\n  }\r\n\r\n  (_options$priority = options.priority) != null ? _options$priority : options.priority = CoroutineGroupPriority.Normal;\r\n  const runtime = groupSet.runtime;\r\n  let currentPriority;\r\n  const runningCoroutines = [];\r\n  const coroutinesData = new Map();\r\n\r\n  const start = genFn => {\r\n    const coroutine = Coroutine(coroutineGroup, GeneratorExecutor(genFn()));\r\n    coroutinesData.set(coroutine, {\r\n      tickWhile: runtime.currentTickCount\r\n    });\r\n    runningCoroutines.push(coroutine);\r\n    return coroutine;\r\n  };\r\n\r\n  const stopAll = (eType = CoroutineStop) => {\r\n    const currentCoroutine = getCurrentCoroutine();\r\n\r\n    if (currentCoroutine?.group.name === name) {\r\n      let error;\r\n      runningCoroutines.forEach(coroutine => {\r\n        if (currentCoroutine === coroutine) {\r\n          try {\r\n            coroutine.stop(eType);\r\n          } catch (e) {\r\n            if (!(e instanceof eType)) {\r\n              throw e;\r\n            }\r\n\r\n            error = e;\r\n          }\r\n        } else {\r\n          coroutine.stop(eType);\r\n        }\r\n      });\r\n\r\n      if (error) {\r\n        throw error;\r\n      }\r\n    } else {\r\n      runningCoroutines.forEach(coroutine => void coroutine.stop(eType));\r\n    }\r\n  };\r\n\r\n  const update = () => {\r\n    if (runningCoroutines.length === 0) {\r\n      return;\r\n    }\r\n\r\n    const currentTick = runtime.currentTickCount;\r\n\r\n    try {\r\n      let idel = -1;\r\n      let idelc;\r\n      let i = 0;\r\n      let imax = runningCoroutines.length;\r\n\r\n      while (i < imax) {\r\n        const coroutine = runningCoroutines[i];\r\n\r\n        if (coroutinesData.get(coroutine).tickWhile < currentTick) {\r\n          coroutine.execute();\r\n        }\r\n\r\n        if (coroutine.isDone()) {\r\n          coroutinesData.delete(coroutine);\r\n\r\n          if (idel > -1) {\r\n            idelc++;\r\n          } else {\r\n            idel = i;\r\n            idelc = 1;\r\n          }\r\n        } else {\r\n          if (idel > -1) {\r\n            runningCoroutines.splice(idel, idelc);\r\n            imax -= idelc;\r\n            i -= idelc;\r\n            idel = -1;\r\n          }\r\n        }\r\n\r\n        i++;\r\n      }\r\n\r\n      if (idel > -1) {\r\n        runningCoroutines.splice(idel, idelc);\r\n      }\r\n    } catch (e) {\r\n      console.error(`[co.CoroutineGroup] internal error: ${valueTypes_cc.errorToString(e)}`);\r\n    }\r\n  };\r\n\r\n  const setPriority = priority => {\r\n    if (currentPriority === undefined || currentPriority !== priority) {\r\n      currentPriority = priority;\r\n      groupSet.updatePriority(coroutineGroup, currentPriority);\r\n    }\r\n  };\r\n\r\n  const onSuspend = coroutine => {};\r\n\r\n  const onResume = coroutine => {\r\n    coroutinesData.get(coroutine).tickWhile = runtime.currentTickCount;\r\n  };\r\n\r\n  const toPublic = (() => {\r\n    const publicCoroutineGroup = {\r\n      get name() {\r\n        return name;\r\n      },\r\n\r\n      get size() {\r\n        return runningCoroutines.length;\r\n      },\r\n\r\n      get priority() {\r\n        return currentPriority;\r\n      },\r\n\r\n      start: genFn => start(genFn).toPublic(),\r\n      stopAll\r\n    };\r\n    return () => publicCoroutineGroup;\r\n  })();\r\n\r\n  const coroutineGroup = {\r\n    // properties\r\n    get name() {\r\n      return name;\r\n    },\r\n\r\n    get groupSet() {\r\n      return groupSet;\r\n    },\r\n\r\n    get size() {\r\n      return runningCoroutines.length;\r\n    },\r\n\r\n    get priority() {\r\n      return currentPriority;\r\n    },\r\n\r\n    // events\r\n    onSuspend,\r\n    onResume,\r\n    // methods\r\n    start,\r\n    stopAll,\r\n    update,\r\n    toPublic\r\n  };\r\n  setPriority(options.priority);\r\n  return addCoroutineGroup(groupSet.add(coroutineGroup));\r\n}\r\n\r\nfunction addCoroutineGroup(coroutineGroup) {\r\n  coroutineGroups.add(coroutineGroup);\r\n  coroutineGroups.add(coroutineGroup.toPublic());\r\n  return coroutineGroup;\r\n}\r\n\r\nfunction isCoroutineGroup(obj) {\r\n  return coroutineGroups.has(obj);\r\n}\r\n\r\nfunction CoroutineGroupSet(runtime) {\r\n  const groups = new Set();\r\n  const nameToGroupMapping = new Map(); // let updatingGroups = false;\r\n\r\n  const groupUpdateOrderList = [];\r\n  let dirtyGroupUpdateOrder = 0;\r\n\r\n  function add(group) {\r\n    groups.add(group);\r\n    groups.add(group.toPublic());\r\n    nameToGroupMapping.set(group.name, group);\r\n    dirtyGroupUpdateOrder |= 1 << 1;\r\n    return group;\r\n  }\r\n\r\n  function has(group) {\r\n    return groups.has(group);\r\n  }\r\n\r\n  function hasByName(groupName) {\r\n    return nameToGroupMapping.has(groupName);\r\n  }\r\n\r\n  function getByName(groupName) {\r\n    if (nameToGroupMapping.has(groupName)) {\r\n      return nameToGroupMapping.get(groupName);\r\n    }\r\n  }\r\n\r\n  function updatePriority(group, priority) {\r\n    dirtyGroupUpdateOrder |= 1 << 0;\r\n  }\r\n\r\n  function sortUpdateOrder(flags) {\r\n    if ((flags & 1 << 1) !== 0) {\r\n      groupUpdateOrderList.splice(0, groupUpdateOrderList.length);\r\n      nameToGroupMapping.forEach(group => void groupUpdateOrderList.push(group));\r\n    }\r\n\r\n    groupUpdateOrderList.sort((a, b) => b.priority - a.priority);\r\n  }\r\n\r\n  function update() {\r\n    if (dirtyGroupUpdateOrder !== 0) {\r\n      const flags = dirtyGroupUpdateOrder;\r\n      dirtyGroupUpdateOrder = 0;\r\n      sortUpdateOrder(flags);\r\n    } // updatingGroups = true;\r\n    // try {\r\n\r\n\r\n    groupUpdateOrderList.forEach(group => void group.update()); // } finally {\r\n    //   updatingGroups = false;\r\n    // }\r\n  }\r\n\r\n  return {\r\n    get runtime() {\r\n      return runtime;\r\n    },\r\n\r\n    add,\r\n    has,\r\n    hasByName,\r\n    getByName,\r\n    updatePriority,\r\n    update\r\n  };\r\n}\r\n\r\nfunction Runtime(tickRate = 0) {\r\n  let autoTickEnabled = false;\r\n  let tickCount = 0;\r\n  let tickTime = 0;\r\n\r\n  function enableAutoTick(tickRate) {\r\n    if (tickRate <= 0) {\r\n      throw new Error(\"'tickRate' must be greater than 0\");\r\n    }\r\n\r\n    if (autoTickEnabled === true) {\r\n      throw new Error('auto-tick has already enabled');\r\n    }\r\n\r\n    autoTickEnabled = true;\r\n    startTick(tickRate);\r\n  }\r\n\r\n  function startTick(tickRate) {\r\n    const interval = Math.floor(1000 / tickRate);\r\n    let schedule;\r\n\r\n    try {\r\n      if (window && 'requestAnimationFrame' in window) {\r\n        let t0 = 0;\r\n\r\n        function tickIfNecessary(t1) {\r\n          if (t1 - t0 >= interval) {\r\n            tick(t1);\r\n            t0 = t1;\r\n          }\r\n\r\n          schedule();\r\n        }\r\n\r\n        schedule = () => void requestAnimationFrame(tickIfNecessary);\r\n\r\n        schedule();\r\n      }\r\n    } catch {}\r\n\r\n    if (schedule === undefined) {\r\n      let nextTime = 0;\r\n\r\n      function tickIfNecessary() {\r\n        const t0 = Date.now();\r\n\r\n        if (t0 >= nextTime) {\r\n          tick(t0);\r\n          const t1 = Date.now();\r\n\r\n          if (t1 - t0 < interval) {\r\n            nextTime = t0 + interval;\r\n            schedule(Math.floor((nextTime - t1) * 0.85));\r\n          } else {\r\n            nextTime = t1;\r\n            schedule(0);\r\n          }\r\n        } else {\r\n          schedule(0);\r\n        }\r\n      }\r\n\r\n      schedule = t => void setTimeout(tickIfNecessary, t);\r\n\r\n      schedule(0);\r\n    }\r\n  }\r\n\r\n  function tick(currentTime) {\r\n    ++tickCount;\r\n    tickTime = currentTime;\r\n    currentRuntime = runtime;\r\n    groupSet.update();\r\n    currentRuntime = null;\r\n  }\r\n\r\n  function manualTick(currentTime) {\r\n    if (autoTickEnabled === true) {\r\n      throw new Error('running in auto-tick mode');\r\n    }\r\n\r\n    ++tickCount;\r\n    tickTime = currentTime;\r\n    const oldRuntime = currentRuntime;\r\n    currentRuntime = runtime;\r\n    groupSet.update();\r\n    currentRuntime = oldRuntime;\r\n  }\r\n\r\n  const toPublic = (() => {\r\n    const publicRuntime = {\r\n      get mainGroup() {\r\n        return mainGroup.toPublic();\r\n      },\r\n\r\n      get currentTickCount() {\r\n        return tickCount;\r\n      },\r\n\r\n      get lastTickTime() {\r\n        return tickTime;\r\n      },\r\n\r\n      enableAutoTick,\r\n      performTick: manualTick\r\n    };\r\n    return () => publicRuntime;\r\n  })();\r\n\r\n  const groupSet = CoroutineGroupSet({\r\n    get currentTickCount() {\r\n      return tickCount;\r\n    },\r\n\r\n    get lastTickTime() {\r\n      return tickTime;\r\n    }\r\n\r\n  });\r\n  const mainGroup = CoroutineGroup(groupSet, 'main', {\r\n    priority: CoroutineGroupPriority.Normal\r\n  });\r\n  const runtime = {\r\n    get groupSet() {\r\n      return groupSet;\r\n    },\r\n\r\n    get mainGroup() {\r\n      return mainGroup;\r\n    },\r\n\r\n    get currentTickCount() {\r\n      return tickCount;\r\n    },\r\n\r\n    get lastTickTime() {\r\n      return tickTime;\r\n    },\r\n\r\n    toPublic\r\n  };\r\n\r\n  if (tickRate > 0) {\r\n    enableAutoTick(tickRate);\r\n  }\r\n\r\n  return runtime;\r\n}\r\nlet currentRuntime = null;\r\nfunction getCurrentRuntime() {\r\n  return currentRuntime;\r\n}\r\n\r\nfunction asAsync(fn) {\r\n  return /*#__PURE__*/regeneratorRuntime.mark(function _callee(...args) {\r\n    var self, cb, done, exception, result, i, value;\r\n    return regeneratorRuntime.wrap(function _callee$(_context) {\r\n      while (1) switch (_context.prev = _context.next) {\r\n        case 0:\r\n          self = this;\r\n          done = false;\r\n          args = args.slice(0); // for (let i = 0; i < args.length; i++) {\r\n\r\n          i = args.length - 1;\r\n          value = args[i];\r\n\r\n          if (typeof value === 'function') {\r\n            cb = value;\r\n\r\n            args[i] = function () {\r\n              try {\r\n                const execResult = cb.apply(null, arguments);\r\n\r\n                if (valueTypes_cc.isObject(execResult)) {\r\n                  exception = execResult.exception;\r\n                  result = execResult.result;\r\n                } else {\r\n                  result = execResult;\r\n                }\r\n              } catch (e) {\r\n                exception = e;\r\n              }\r\n\r\n              done = true;\r\n            }; // break;\r\n\r\n          } // }\r\n\r\n\r\n          if (!cb) {\r\n            _context.next = 17;\r\n            break;\r\n          }\r\n\r\n          fn.apply(self, args);\r\n\r\n        case 8:\r\n          if (done) {\r\n            _context.next = 13;\r\n            break;\r\n          }\r\n\r\n          _context.next = 11;\r\n          return;\r\n\r\n        case 11:\r\n          _context.next = 8;\r\n          break;\r\n\r\n        case 13:\r\n          if (!exception) {\r\n            _context.next = 15;\r\n            break;\r\n          }\r\n\r\n          throw exception;\r\n\r\n        case 15:\r\n          _context.next = 18;\r\n          break;\r\n\r\n        case 17:\r\n          result = fn.apply(self, args);\r\n\r\n        case 18:\r\n          return _context.abrupt(\"return\", result);\r\n\r\n        case 19:\r\n        case \"end\":\r\n          return _context.stop();\r\n      }\r\n    }, _callee, this);\r\n  });\r\n}\r\n\r\nfunction startStopwatch() {\r\n  const runtime = getCurrentRuntime();\r\n\r\n  if (!runtime) {\r\n    throw new Error(\"'startStopwatch' must be run in coroutine\");\r\n  }\r\n\r\n  let time0, tick0;\r\n  const stopwatch = {\r\n    get elapsedSeconds() {\r\n      return (runtime.lastTickTime - time0) / 1000;\r\n    },\r\n\r\n    get elapsedMilliseconds() {\r\n      return runtime.lastTickTime - time0;\r\n    },\r\n\r\n    get elapsedTicks() {\r\n      return runtime.currentTickCount - tick0;\r\n    },\r\n\r\n    restart() {\r\n      time0 = runtime.lastTickTime;\r\n      tick0 = runtime.currentTickCount;\r\n    }\r\n\r\n  };\r\n  stopwatch.restart();\r\n  return stopwatch;\r\n}\r\n\r\nfunction start(group, genFn) {\r\n  return isCoroutine(genFn) ? genFn : group.start(genFn);\r\n}\r\n\r\nfunction stopAll(coroutines) {\r\n  if (coroutines.size > 0) {\r\n    coroutines.forEach(coroutine => void coroutine.stop()); // coroutines.clear();\r\n  }\r\n} // startAll(a, b, c, d);\r\n// startAll([a, b, c, d]);\r\n// startAll({ 0: a, 1: b, 2: c, 3: d });\r\n\r\n\r\nfunction startAll(caller, genFns) {\r\n  const currentGroup = getCurrentCoroutine()?.group;\r\n\r\n  if (!currentGroup) {\r\n    throw new Error(`'${caller}' must be run in coroutine`);\r\n  } // if (arguments.length > 1) {\r\n  //   genFns = Array.prototype.slice.call(arguments);\r\n  // }\r\n\r\n\r\n  const coroutines = new Map();\r\n\r\n  if (valueTypes_cc.isArray(genFns)) {\r\n    genFns.forEach((genFn, genFnIndex) => void coroutines.set(genFnIndex, start(currentGroup, genFn)));\r\n  } else if (valueTypes_cc.isObject(genFns)) {\r\n    Object.keys(genFns).forEach(genFnName => void coroutines.set(genFnName, start(currentGroup, genFns[genFnName])));\r\n  }\r\n\r\n  coroutines.stopAll = () => void stopAll(coroutines);\r\n\r\n  return coroutines;\r\n}\r\n\r\nvar _marked$7 = /*#__PURE__*/regeneratorRuntime.mark(waitForAll);\r\nfunction waitForAll(genFns) {\r\n  var result, coroutines;\r\n  return regeneratorRuntime.wrap(function waitForAll$(_context) {\r\n    while (1) switch (_context.prev = _context.next) {\r\n      case 0:\r\n        result = {};\r\n        coroutines = startAll('waitForAll', genFns);\r\n\r\n        if (!(coroutines.size > 0)) {\r\n          _context.next = 18;\r\n          break;\r\n        }\r\n\r\n        _context.prev = 3;\r\n\r\n      case 4:\r\n\r\n        coroutines.forEach((coroutine, name) => {\r\n          if (coroutine.isDone()) {\r\n            result[name] = {\r\n              exception: coroutine.exception,\r\n              result: coroutine.result\r\n            };\r\n            coroutines.delete(name);\r\n          }\r\n        });\r\n\r\n        if (!(coroutines.size === 0)) {\r\n          _context.next = 8;\r\n          break;\r\n        }\r\n\r\n        return _context.abrupt(\"break\", 12);\r\n\r\n      case 8:\r\n        _context.next = 10;\r\n        return;\r\n\r\n      case 10:\r\n        _context.next = 4;\r\n        break;\r\n\r\n      case 12:\r\n        _context.next = 18;\r\n        break;\r\n\r\n      case 14:\r\n        _context.prev = 14;\r\n        _context.t0 = _context[\"catch\"](3);\r\n        coroutines.stopAll();\r\n        throw _context.t0;\r\n\r\n      case 18:\r\n        return _context.abrupt(\"return\", result);\r\n\r\n      case 19:\r\n      case \"end\":\r\n        return _context.stop();\r\n    }\r\n  }, _marked$7, null, [[3, 14]]);\r\n}\r\n\r\nvar _marked$6 = /*#__PURE__*/regeneratorRuntime.mark(waitForAny);\r\nfunction waitForAny(genFns) {\r\n  var result, coroutines, any;\r\n  return regeneratorRuntime.wrap(function waitForAny$(_context) {\r\n    while (1) switch (_context.prev = _context.next) {\r\n      case 0:\r\n        result = {};\r\n        coroutines = startAll('waitForAny', genFns);\r\n\r\n        if (!(coroutines.size > 0)) {\r\n          _context.next = 20;\r\n          break;\r\n        }\r\n\r\n        _context.prev = 3;\r\n\r\n      case 4:\r\n\r\n        any = false;\r\n        coroutines.forEach((coroutine, name) => {\r\n          if (coroutine.isDone()) {\r\n            result[name] = {\r\n              exception: coroutine.exception,\r\n              result: coroutine.result\r\n            };\r\n            coroutines.delete(name);\r\n            any = true;\r\n          }\r\n        });\r\n\r\n        if (!any) {\r\n          _context.next = 10;\r\n          break;\r\n        }\r\n\r\n        coroutines.stopAll();\r\n        return _context.abrupt(\"break\", 14);\r\n\r\n      case 10:\r\n        _context.next = 12;\r\n        return;\r\n\r\n      case 12:\r\n        _context.next = 4;\r\n        break;\r\n\r\n      case 14:\r\n        _context.next = 20;\r\n        break;\r\n\r\n      case 16:\r\n        _context.prev = 16;\r\n        _context.t0 = _context[\"catch\"](3);\r\n        coroutines.stopAll();\r\n        throw _context.t0;\r\n\r\n      case 20:\r\n        return _context.abrupt(\"return\", result);\r\n\r\n      case 21:\r\n      case \"end\":\r\n        return _context.stop();\r\n    }\r\n  }, _marked$6, null, [[3, 16]]);\r\n}\r\n\r\nvar _marked$5 = /*#__PURE__*/regeneratorRuntime.mark(waitForTime);\r\n\r\nfunction waitForTime(runtime, time) {\r\n  var time0, elapsedTime;\r\n  return regeneratorRuntime.wrap(function waitForTime$(_context) {\r\n    while (1) switch (_context.prev = _context.next) {\r\n      case 0:\r\n        if (!(time > 0)) {\r\n          _context.next = 10;\r\n          break;\r\n        }\r\n\r\n        time0 = runtime.lastTickTime;\r\n\r\n      case 2:\r\n\r\n        elapsedTime = runtime.lastTickTime - time0;\r\n\r\n        if (!(elapsedTime >= time)) {\r\n          _context.next = 6;\r\n          break;\r\n        }\r\n\r\n        return _context.abrupt(\"break\", 10);\r\n\r\n      case 6:\r\n        _context.next = 8;\r\n        return;\r\n\r\n      case 8:\r\n        _context.next = 2;\r\n        break;\r\n\r\n      case 10:\r\n      case \"end\":\r\n        return _context.stop();\r\n    }\r\n  }, _marked$5);\r\n}\r\n\r\nvar _marked$4 = /*#__PURE__*/regeneratorRuntime.mark(waitForMilliseconds);\r\nfunction waitForMilliseconds(milliseconds) {\r\n  var runtime;\r\n  return regeneratorRuntime.wrap(function waitForMilliseconds$(_context) {\r\n    while (1) switch (_context.prev = _context.next) {\r\n      case 0:\r\n        runtime = getCurrentRuntime();\r\n\r\n        if (runtime) {\r\n          _context.next = 3;\r\n          break;\r\n        }\r\n\r\n        throw new Error(\"'waitForMilliseconds' must be run in coroutine\");\r\n\r\n      case 3:\r\n        _context.next = 5;\r\n        return waitForTime(runtime, Math.max(milliseconds, 0));\r\n\r\n      case 5:\r\n      case \"end\":\r\n        return _context.stop();\r\n    }\r\n  }, _marked$4);\r\n}\r\n\r\nvar _marked$3 = /*#__PURE__*/regeneratorRuntime.mark(waitForSeconds);\r\nfunction waitForSeconds(seconds) {\r\n  var runtime;\r\n  return regeneratorRuntime.wrap(function waitForSeconds$(_context) {\r\n    while (1) switch (_context.prev = _context.next) {\r\n      case 0:\r\n        runtime = getCurrentRuntime();\r\n\r\n        if (runtime) {\r\n          _context.next = 3;\r\n          break;\r\n        }\r\n\r\n        throw new Error(\"'waitForSeconds' must be run in coroutine\");\r\n\r\n      case 3:\r\n        _context.next = 5;\r\n        return waitForTime(runtime, Math.max(seconds * 1000, 0));\r\n\r\n      case 5:\r\n      case \"end\":\r\n        return _context.stop();\r\n    }\r\n  }, _marked$3);\r\n}\r\n\r\nvar _marked$2 = /*#__PURE__*/regeneratorRuntime.mark(waitForTicks);\r\n\r\nfunction waitForTicks(ticks) {\r\n  var maxTicks, tickCnt;\r\n  return regeneratorRuntime.wrap(function waitForTicks$(_context) {\r\n    while (1) switch (_context.prev = _context.next) {\r\n      case 0:\r\n        maxTicks = Math.max(ticks, 0);\r\n\r\n        if (!(maxTicks > 0)) {\r\n          _context.next = 10;\r\n          break;\r\n        }\r\n\r\n        tickCnt = 0;\r\n\r\n      case 3:\r\n\r\n        if (!(++tickCnt > maxTicks)) {\r\n          _context.next = 6;\r\n          break;\r\n        }\r\n\r\n        return _context.abrupt(\"break\", 10);\r\n\r\n      case 6:\r\n        _context.next = 8;\r\n        return;\r\n\r\n      case 8:\r\n        _context.next = 3;\r\n        break;\r\n\r\n      case 10:\r\n      case \"end\":\r\n        return _context.stop();\r\n    }\r\n  }, _marked$2);\r\n}\r\n\r\nvar _marked$1 = /*#__PURE__*/regeneratorRuntime.mark(waitUntil);\r\n\r\n// action: wait until action returns true\r\nfunction waitUntil(action) {\r\n  return regeneratorRuntime.wrap(function waitUntil$(_context) {\r\n    while (1) switch (_context.prev = _context.next) {\r\n      case 0:\r\n        if (!(action() !== true)) {\r\n          _context.next = 5;\r\n          break;\r\n        }\r\n\r\n        _context.next = 3;\r\n        return;\r\n\r\n      case 3:\r\n        _context.next = 0;\r\n        break;\r\n\r\n      case 5:\r\n      case \"end\":\r\n        return _context.stop();\r\n    }\r\n  }, _marked$1);\r\n}\r\n\r\nvar _marked = /*#__PURE__*/regeneratorRuntime.mark(waitWhile);\r\n\r\n// action: wait until action returns false\r\nfunction waitWhile(action) {\r\n  return regeneratorRuntime.wrap(function waitWhile$(_context) {\r\n    while (1) switch (_context.prev = _context.next) {\r\n      case 0:\r\n        if (!(action() === true)) {\r\n          _context.next = 5;\r\n          break;\r\n        }\r\n\r\n        _context.next = 3;\r\n        return;\r\n\r\n      case 3:\r\n        _context.next = 0;\r\n        break;\r\n\r\n      case 5:\r\n      case \"end\":\r\n        return _context.stop();\r\n    }\r\n  }, _marked);\r\n}\r\n\r\nvar utils = /*#__PURE__*/Object.freeze({\r\n  __proto__: null,\r\n  asAsync: asAsync,\r\n  startStopwatch: startStopwatch,\r\n  waitForAll: waitForAll,\r\n  waitForAny: waitForAny,\r\n  waitForMilliseconds: waitForMilliseconds,\r\n  waitForSeconds: waitForSeconds,\r\n  waitForTicks: waitForTicks,\r\n  waitUntil: waitUntil,\r\n  waitWhile: waitWhile\r\n});\r\n\r\nfunction isGenerator(value) {\r\n  return getType(value) === GeneratorType;\r\n}\r\n\r\nfunction isGeneratorFunction(value) {\r\n  return getType(value) === GeneratorFunctionType;\r\n}\r\n\r\nfunction isAsyncFunction(value) {\r\n  return getType(value) === AsyncFunctionType;\r\n}\r\n\r\nfunction isPromise(value) {\r\n  return getType(value) === PromiseType;\r\n}\r\n\r\nfunction exportRuntime(runtime) {\r\n  const groupSet = runtime.groupSet;\r\n  const mainGroup = runtime.mainGroup;\r\n\r\n  function startCoroutine(genFn) {\r\n    return mainGroup.start(genFn).toPublic();\r\n  }\r\n\r\n  function addProperty(obj, name, getter) {\r\n    Object.defineProperty(obj, name, {\r\n      enumerable: true,\r\n      configurable: true,\r\n      get: getter\r\n    });\r\n  }\r\n\r\n  const publicRuntime = runtime.toPublic();\r\n  addProperty(publicRuntime, 'current', () => getCurrentCoroutine()?.toPublic());\r\n  addProperty(publicRuntime, 'currentRuntime', () => getCurrentRuntime()?.toPublic());\r\n  addProperty(publicRuntime, 'CoroutineStop', () => CoroutineStop);\r\n  publicRuntime.start = startCoroutine;\r\n  publicRuntime.isCoroutine = isCoroutine;\r\n  publicRuntime.isCoroutineGroup = isCoroutineGroup;\r\n  publicRuntime.isGenerator = isGenerator;\r\n  publicRuntime.isGeneratorFunction = isGeneratorFunction;\r\n  publicRuntime.isAsyncFunction = isAsyncFunction;\r\n  publicRuntime.isPromise = isPromise; // isGenerator/isGeneratorFunction/isAsyncFunction/isPromise\r\n  // yield + [Generator/GeneratorFunction/AsyncFunction/Promise]\r\n\r\n  publicRuntime.isSupportedAsync = isSupportedAsync;\r\n  publicRuntime.promiseToGenerator = promiseToGenerator;\r\n\r\n  publicRuntime.Runtime = tickRate => exportRuntime(Runtime(tickRate));\r\n\r\n  publicRuntime.CoroutineGroup = (name, options) => CoroutineGroup(groupSet, name, options).toPublic();\r\n\r\n  publicRuntime.CoroutineGroup.getGroupByName = name => groupSet.getByName(name)?.toPublic();\r\n\r\n  publicRuntime.CoroutineGroup.hasGroup = groupSet.has;\r\n  publicRuntime.CoroutineGroup.hasGroupByName = groupSet.hasByName;\r\n  Reflect.ownKeys(CoroutineGroupPriority).forEach(priorityName => void addProperty(publicRuntime.CoroutineGroup, `${priorityName}Priority`, () => CoroutineGroupPriority[priorityName]));\r\n  Reflect.ownKeys(utils).forEach(fnName => void (publicRuntime[fnName] = utils[fnName]));\r\n  return publicRuntime;\r\n}\r\n\r\nvar index = exportRuntime(Runtime());\r\n\r\nmodule.exports = index;\r\n"]}