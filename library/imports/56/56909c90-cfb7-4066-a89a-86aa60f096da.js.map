{"version":3,"sources":["assets\\scripts\\performanceController.js"],"names":["PublicSetUp","require","cc","Class","Component","properties","onLoad","find","node","active","linesNode","i","childrenCount","getChildByName","anchorsNode","col","j","row","getComponent","Sprite","spriteFrame","start","store","symbolDataList","Array","randomSymbolDataList","length","jcnt","Math","floor","random","iGrid","gameResult","k","co","gameResultGotStatus","iGrid0","waitUntil","playing","auto","AutoPlayButton","ManuaPlayButton","waitForSeconds","update","dt","d","Date","Label","string","getHours","getMinutes","getSeconds"],"mappings":"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","sourceRoot":"/","sourcesContent":["import buildSymbols from './buildSymbols';\nimport co from './co.cc';\nimport playAll from './playAll';\nimport shuffle from './shuffle';\n\nimport requestTableInfo from './requestTableInfo';\nimport requestGameResult from './requestGameResult';\nlet PublicSetUp=require('PublicSetUp');\n\ncc.Class({\n  extends: cc.Component,\n  properties: {\n    \n\n  },\n  onLoad() {\n\n    cc.find('Symbols', this.node).active = false;\n    cc.find('Effect', this.node).active = false;\n    const linesNode = cc.find('Lines', this.node);\n    for (let i = 0; i < linesNode.childrenCount; i++) {\n      linesNode.getChildByName(`${i + 1}`).active = false;\n    }\n\n    const anchorsNode = cc.find('Anchors', this.node);\n    for (let i = 1; i <= 5; i++) {\n      const col = anchorsNode.getChildByName(`${i}`);\n      for (let j = 1; j <= 3; j++) {\n        const row = col.getChildByName(`${j}`);\n        row.getComponent(cc.Sprite).spriteFrame = null;\n      }\n    }\n   \n  },\n\n  start() {\n    \n    cc.store.symbolDataList = new Array(5);\n    cc.store.randomSymbolDataList = new Array(cc.store.symbolDataList.length);\n\n    const { symbolDataList, randomSymbolDataList } = cc.store;\n    for (let i = 0; i < randomSymbolDataList.length; i++) {\n      symbolDataList[i] = new Array(24);\n      randomSymbolDataList[i] = new Array(symbolDataList[i].length);\n      for (let j = 0, jcnt = randomSymbolDataList[i].length; j < jcnt; j++) {\n        randomSymbolDataList[i][j] = Math.floor(Math.random() * 11);\n      }\n    }\n\n    const { iGrid } = cc.store.gameResult;\n    for (let i = 0; i < symbolDataList.length; i++) {\n      shuffle(randomSymbolDataList[i]);\n\n      let j, k;\n\n      j = 0;\n      while (j < 3) {\n        symbolDataList[i][j] = iGrid[i + 5 * (2 - j)];\n        j++;\n      }\n\n      k = symbolDataList[i].length;\n      while (j < k) {\n        symbolDataList[i][j] = randomSymbolDataList[i][j];\n        j++;\n      }\n    }\n    buildSymbols(symbolDataList);\n\n    co.start(function* () {\n      while (true) {\n        cc.store.gameResultGotStatus = 0;\n\n        const { symbolDataList, randomSymbolDataList } = cc.store;\n        const iGrid0 = cc.store.gameResult.iGrid;\n        for (let i = 0; i < symbolDataList.length; i++) {\n          shuffle(randomSymbolDataList[i]);\n\n          let j, k;\n\n          j = 0;\n          k = symbolDataList[i].length - 1;\n          while (j < 3) {\n            symbolDataList[i][j] = iGrid0[i + 5 * (2 - j)];\n            symbolDataList[i][k - j] = iGrid0[i + 5 * j];\n            j++;\n          }\n\n          k = symbolDataList[i].length - 3;\n          while (j < k) {\n            symbolDataList[i][j] = randomSymbolDataList[i][j];\n            j++;\n          }\n        }\n        buildSymbols(symbolDataList);\n\n\n        yield co.waitUntil(() => cc.store.playing === true);\n\n        requestGameResult();\n        \n        yield playAll();\n\n        requestTableInfo();\n\n        if (cc.store.playing === true) {\n          if(cc.store.auto==false){\n            cc.store.playing=false;\n            const AutoPlayButton = cc.find('Canvas/Game/Machine/UpUI/MenuPanel/playButton');\n            AutoPlayButton.active = true;\n            const ManuaPlayButton = cc.find('Canvas/Game/Machine/UpUI/MenuPanel/PauseButton');\n            ManuaPlayButton.active = false;\n          }\n          yield co.waitForSeconds(1.2);\n        }\n      }\n    });\n  },\n  update (dt) {\n    var d=new Date();\n    cc.find(\"Canvas/Game/Machine/UpUI/time/txt\").getComponent(cc.Label).string=d.getHours()+\":\"+d.getMinutes()+\":\"+d.getSeconds();\n\n  },\n\n  \n\n});\n"]}