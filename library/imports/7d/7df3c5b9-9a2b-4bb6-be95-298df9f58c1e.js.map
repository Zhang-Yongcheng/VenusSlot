{"version":3,"sources":["assets\\scripts\\playLine.js"],"names":["playLine","lineIndex","frameCnt","slideEffect","keepVisible","speed","duration","linesNode","cc","find","lineNode","getChildByName","active","x","width","co","start","t0","currentRuntime","lastTickTime","dt","dx","t1","effects","frames","lineFrames","i","push","waitForMilliseconds","forEach","effect","stop"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AACA;;;;mDAEyBA;;AAAV,SAAUA,QAAV,CAAmBC,SAAnB,EAA8BC,QAA9B,EAAwCC,WAAxC,EAAqDC,WAArD,EAAkEC,KAAlE,EAAyEC,QAAzE;AAAA;AAAA;AAAA;AAAA;AAAA;AACPC,UAAAA,SADO,GACKC,EAAE,CAACC,IAAH,CAAQ,uCAAR,CADL;AAEPC,UAAAA,QAFO,GAEIH,SAAS,CAACI,cAAV,OAA4BV,SAAS,GAAG,CAAxC,EAFJ;AAGbS,UAAAA,QAAQ,CAACE,MAAT,GAAkB,IAAlB;;AAHa,gBAKTT,WAAW,KAAK,IALP;AAAA;AAAA;AAAA;;AAMXO,UAAAA,QAAQ,CAACG,CAAT,IAAcN,SAAS,CAACO,KAAxB;AANW;AAQX,iBAAMC,eAAGC,KAAH,uCAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEPC,oBAAAA,EAFO,GAEFF,eAAGG,cAAH,CAAkBC,YAFhB;AAGPC,oBAAAA,EAHO,GAGF,CAHE;;AAAA;AAAA,yBAKJ,IALI;AAAA;AAAA;AAAA;;AAMHC,oBAAAA,EANG,GAMEhB,KAAK,GAAGe,EANV;AAOTV,oBAAAA,QAAQ,CAACG,CAAT,IAAcQ,EAAd;;AAPS,0BAQLX,QAAQ,CAACG,CAAT,IAAc,CART;AAAA;AAAA;AAAA;;AASPH,oBAAAA,QAAQ,CAACG,CAAT,GAAa,CAAb;AATO;;AAAA;AAAA;AAaT;;AAbS;AAeHS,oBAAAA,EAfG,GAeEP,eAAGG,cAAH,CAAkBC,YAfpB;AAgBTC,oBAAAA,EAAE,GAAGE,EAAE,GAAGL,EAAV;AACAA,oBAAAA,EAAE,GAAGK,EAAL;AAjBS;AAAA;;AAAA;AAAA;AAoBXZ,oBAAAA,QAAQ,CAACG,CAAT,GAAa,CAAb;AApBW;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAT,EAAN;;AARW;AAAA;AAkCLU,UAAAA,OAlCK,GAkCK,EAlCL;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAoCHC,oBAAAA,MApCG,GAoCMC,uBAAWxB,SAAS,GAAG,CAAvB,CApCN;;AAAA,2CAqCAyB,CArCA;AAsCPH,sBAAAA,OAAO,CAACI,IAAR,CACEZ,eAAGC,KAAH,uCAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AACP,uCAAM,4BAAW,iCAAgBQ,MAAM,CAACE,CAAD,CAAtB,CAAX,EAAuC,IAAvC,CAAN;;AADO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAAT,EADF;AAtCO;;AAqCT,yBAASA,CAAT,GAAa,CAAb,EAAgBA,CAAC,GAAGxB,QAApB,EAA8BwB,CAAC,EAA/B,EAAmC;AAAA,4BAA1BA,CAA0B;AAMlC;;AA3CQ;AA4CT,2BAAMX,eAAGa,mBAAH,CAAuBtB,QAAvB,CAAN;;AA5CS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AA8CTiB,UAAAA,OAAO,CAACM,OAAR,CAAgB,UAAAC,MAAM;AAAA,mBAAIA,MAAM,CAACC,IAAP,EAAJ;AAAA,WAAtB;AA9CS;;AAAA;AAAA;;AAiDX,cAAI3B,WAAW,KAAK,KAApB,EAA2B;AACzBM,YAAAA,QAAQ,CAACE,MAAT,GAAkB,KAAlB;AACD;;AAnDU;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA","sourceRoot":"/","sourcesContent":["import co from './co.cc';\nimport getSymbolAnchor from './getSymbolAnchor';\nimport lineFrames from './lineFrames';\nimport playEffect from './playEffect';\n\nexport default function* playLine(lineIndex, frameCnt, slideEffect, keepVisible, speed, duration) {\n  const linesNode = cc.find('Canvas/Game/Machine/Performance/Lines');\n  const lineNode = linesNode.getChildByName(`${lineIndex + 1}`);\n  lineNode.active = true;\n\n  if (slideEffect === true) {\n    lineNode.x -= linesNode.width;\n\n    yield co.start(function* () {\n      try {\n        let t0 = co.currentRuntime.lastTickTime;\n        let dt = 0;\n\n        while (true) {\n          const dx = speed * dt;\n          lineNode.x += dx;\n          if (lineNode.x >= 0) {\n            lineNode.x = 0;\n            break;\n          }\n\n          yield;\n\n          const t1 = co.currentRuntime.lastTickTime;\n          dt = t1 - t0;\n          t0 = t1;\n        }\n      } finally {\n        lineNode.x = 0;\n      }\n    });\n  }\n\n  try {\n    const effects = [];\n    try {\n      const frames = lineFrames[lineIndex + 1];\n      for (let i = 0; i < frameCnt; i++) {\n        effects.push(\n          co.start(function* () {\n            yield playEffect(getSymbolAnchor(frames[i]), 2000);\n          })\n        );\n      }\n      yield co.waitForMilliseconds(duration);\n    } finally {\n      effects.forEach(effect => effect.stop());\n    }\n  } finally {\n    if (keepVisible === false) {\n      lineNode.active = false;\n    }\n  }\n}\n"]}