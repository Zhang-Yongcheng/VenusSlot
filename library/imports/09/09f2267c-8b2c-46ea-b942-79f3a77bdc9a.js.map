{"version":3,"sources":["assets\\scripts\\playAll.js"],"names":["playAll","PublicSetUp","require","addFloat","mulFloat","num1","num2","m","s1","toString","s2","split","length","e","Number","replace","Math","pow","r1","r2","max","cols","i","push","co","start","sound","cc","audioEngine","playEffect","audio","waitForAll","store","gameResult","type","iLine","iFrame","freeGameNCnts","WinPointLine","WinTotalPoint","heart","VideoIdx","lastLine","score","find","getComponent","Label","string","run","lines","playMusic","MusicClip","heartObj","show","anim","auto","play","waitForSeconds","_total","freeSpinTotal","FreeTotalPoint","UIOff","userPoints"],"mappings":"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","sourceRoot":"/","sourcesContent":["import co from './co.cc';\r\nimport playLine from './playLine';\r\nimport playSymbolCol from './playSymbolCol';\r\nimport playVideo from './playVideo';\r\nlet PublicSetUp=require('PublicSetUp');\r\n\r\n\r\nexport default function* playAll() {\r\n\r\n\r\n  function addFloat(num1,num2){\r\n    var r1, r2, m;\r\n    try{ \r\n        r1 = num1.toString().split(\".\")[1].length; \r\n    }catch(e){\r\n        r1 = 0; \r\n    }\r\n    try{\r\n        r2 = num2.toString().split(\".\")[1].length;\r\n    } catch(e){\r\n        r2 = 0;\r\n    }\r\n    m = Math.pow(10, Math.max(r1, r2));\r\n    return (mulFloat(num1, m) + mulFloat(num2, m)) / m;\r\n  }\r\n  function mulFloat(num1,num2){\r\n    var m = 0, s1 = num1.toString(), s2 = num2.toString();\r\n    try{ \r\n        m += s1.split(\".\")[1].length; \r\n    }catch(e){ }\r\n    try{\r\n        m += s2.toString().split(\".\")[1].length;\r\n    } catch(e){ }\r\n \r\n    return Number(s1.replace(\".\", \"\")) * Number(s2.replace(\".\", \"\")) / Math.pow(10, m);\r\n}\r\n  // 1\r\n  const cols = [];\r\n  for (let i = 0; i < 5; i++) {\r\n    cols.push(\r\n      co.start(function* () {\r\n\r\n        yield playSymbolCol(i, 3.0);\r\n\r\n      })\r\n    );\r\n  }\r\n\r\nif(PublicSetUp.sound==1){\r\n            \r\n  cc.audioEngine.playEffect(PublicSetUp.audio[\"0024\"], false);\r\n}\r\n  yield co.waitForAll(cols);\r\n  const {type, iLine, iFrame,freeGameNCnts, WinPointLine, WinTotalPoint ,heart,VideoIdx} = cc.store.gameResult;\r\n\r\n  // 2\r\n  let lastLine = -1;\r\n  for (let i = 9 - 1; i >= 0; i--) {\r\n    if (iLine[i] === 1) {\r\n      lastLine = i;\r\n      break;\r\n    }\r\n  }\r\n  let score=cc.find('Canvas/Game/score').getComponent(\"score\");\r\n  if (lastLine > -1) {\r\n    for (let i = 0; i < 9; i++) {\r\n      if (iLine[i] === 1) {\r\n        cc.find('Canvas/Game/Machine/UI/GameScore/Value').getComponent(cc.Label).string = cc.store.gameResult.WinPointLine[i];\r\n\r\n        score.run(cc.store.gameResult.WinPointLine[i]);\r\n        if(PublicSetUp.sound==1){\r\n            \r\n          cc.audioEngine.playEffect(PublicSetUp.audio[\"0022\"], false);\r\n        }\r\n        yield playLine(i, iFrame[i], true, i === lastLine, 4.5, 1000);\r\n\r\n      }\r\n    }\r\n\r\n    // 3\r\n    const lines = [];\r\n    for (let i = 0; i < 9; i++) {\r\n      if (iLine[i] === 1) {\r\n        lines.push(\r\n          co.start(function* () {\r\n            yield playLine(i, iFrame[i], false, false, 4.5, 1500);\r\n\r\n          })\r\n        );\r\n      }\r\n    }\r\n    cc.find('Canvas/Game/Machine/UI/GameScore/Value').getComponent(cc.Label).string = cc.store.gameResult.WinTotalPoint;\r\n\r\n    yield co.waitForAll(lines);\r\n\r\n    // 4\r\n    if (lines.length >= 2) {\r\n      yield playVideo('random',0);\r\n\r\n\r\n      if(PublicSetUp.sound==1){\r\n        cc.audioEngine.playMusic(PublicSetUp.MusicClip, true);\r\n      }\r\n      \r\n      \r\n    }\r\n  }\r\n  \r\n\r\n    let heartObj=cc.find('Canvas/Game/heartPanel').getComponent(\"heart\");\r\n    heartObj.show(heart);\r\n\r\n\r\n    if(VideoIdx!=null && VideoIdx!=0){\r\n      yield playVideo('index',VideoIdx);\r\n    }\r\n\r\n    //freeSpin\r\n    let anim = cc.find('Canvas/Game/FreeSpin').getComponent(\"freeSpinAnim\");\r\n    if(freeGameNCnts[0]==1 && cc.store.type==0){\r\n      //有中免費遊戲(第一次)\r\n      \r\n      if(cc.store.auto==false){\r\n        //如果目前不是自動\r\n        //則結束後改手動\r\n        cc.store.type=3;\r\n      }else{\r\n        cc.store.type=2;\r\n      }\r\n      \r\n      cc.store.auto=true;\r\n      anim.play();\r\n      yield co.waitForSeconds(3.1);\r\n      cc.find('Canvas/Game/Machine/UI/FreeSpinsPanel/cnt').getComponent(cc.Label).string=freeGameNCnts[1];\r\n      \r\n    }else if(type==2){\r\n      //如果目前是免費遊戲\r\n      cc.find('Canvas/Game/Machine/UI/FreeSpinsPanel/cnt').getComponent(cc.Label).string=freeGameNCnts[2];\r\n      let _total =addFloat(PublicSetUp.freeSpinTotal,cc.store.gameResult.WinTotalPoint);    \r\n      PublicSetUp.freeSpinTotal=_total;\r\n      cc.find('Canvas/Game/Machine/UI/FreeSpinsPanel/total').getComponent(cc.Label).string=PublicSetUp.freeSpinTotal;\r\n      if(freeGameNCnts[2]==0){\r\n        cc.store.type=1;\r\n      }\r\n    }\r\n    \r\n    if(cc.store.type==1){\r\n      //最後一次\r\n      cc.store.type=0;\r\n      if(cc.store.FreeTotalPoint!=null){\r\n        cc.find('Canvas/Game/Machine/UI/FreeSpinsPanel/total').getComponent(cc.Label).string=cc.store.FreeTotalPoint;\r\n      }\r\n      \r\n      yield co.waitForSeconds(2);     \r\n      anim.UIOff();\r\n      PublicSetUp.freeSpinTotal=0\r\n      if(cc.store.type==3){\r\n        cc.store.auto=false;\r\n      }\r\n    }\r\n\r\n\r\n\r\n  cc.find('Canvas/Game/Machine/UI/GameScore/Value').getComponent(cc.Label).string = 0;\r\n\r\n  // update user points\r\n  cc.find('Canvas/Game/Machine/UI/GamePoint/Value').getComponent(cc.Label).string = cc.store.userPoints;\r\n}\r\n"]}