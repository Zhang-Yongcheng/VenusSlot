{"version":3,"sources":["assets\\scripts\\playAll.js"],"names":["playAll","PublicSetUp","require","addFloat","mulFloat","num1","num2","m","s1","toString","s2","split","length","e","Number","replace","Math","pow","r1","r2","max","cols","i","push","co","start","waitForAll","cc","store","gameResult","type","iLine","iFrame","freeGameNCnts","WinPointLine","WinTotalPoint","lastLine","find","getComponent","Label","string","lines","active","audioEngine","stopAll","audio1","sound","playMusic","MusicClip","anim","auto","play","waitForSeconds","_total","freeSpinTotal","FreeTotalPoint","UIOff","userPoints"],"mappings":"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","sourceRoot":"/","sourcesContent":["import co from './co.cc';\r\nimport playLine from './playLine';\r\nimport playSymbolCol from './playSymbolCol';\r\nimport playVideo from './playVideo';\r\nimport { test } from './PublicSetUp';\r\nlet PublicSetUp=require('PublicSetUp');\r\n\r\n\r\nexport default function* playAll() {\r\n\r\n\r\n  function addFloat(num1,num2){\r\n    var r1, r2, m;\r\n    try{ \r\n        r1 = num1.toString().split(\".\")[1].length; \r\n    }catch(e){\r\n        r1 = 0; \r\n    }\r\n    try{\r\n        r2 = num2.toString().split(\".\")[1].length;\r\n    } catch(e){\r\n        r2 = 0;\r\n    }\r\n    m = Math.pow(10, Math.max(r1, r2));\r\n    return (mulFloat(num1, m) + mulFloat(num2, m)) / m;\r\n  }\r\n  function mulFloat(num1,num2){\r\n    var m = 0, s1 = num1.toString(), s2 = num2.toString();\r\n    try{ \r\n        m += s1.split(\".\")[1].length; \r\n    }catch(e){ }\r\n    try{\r\n        m += s2.toString().split(\".\")[1].length;\r\n    } catch(e){ }\r\n \r\n    return Number(s1.replace(\".\", \"\")) * Number(s2.replace(\".\", \"\")) / Math.pow(10, m);\r\n}\r\n  // 1\r\n  const cols = [];\r\n  for (let i = 0; i < 5; i++) {\r\n    cols.push(\r\n      co.start(function* () {\r\n\r\n        yield playSymbolCol(i, 3.0);\r\n\r\n      })\r\n    );\r\n  }\r\n  yield co.waitForAll(cols);\r\n  const {type, iLine, iFrame,freeGameNCnts, WinPointLine, WinTotalPoint } = cc.store.gameResult;\r\n\r\n  // 2\r\n  let lastLine = -1;\r\n  for (let i = 9 - 1; i >= 0; i--) {\r\n    if (iLine[i] === 1) {\r\n      lastLine = i;\r\n      break;\r\n    }\r\n  }\r\n  if (lastLine > -1) {\r\n    for (let i = 0; i < 9; i++) {\r\n      if (iLine[i] === 1) {\r\n        cc.find('Canvas/Game/Machine/UI/GameScore/Value').getComponent(cc.Label).string = cc.store.gameResult.WinPointLine[i];\r\n        yield playLine(i, iFrame[i], true, i === lastLine, 4.5, 3200);\r\n\r\n      }\r\n    }\r\n\r\n    // 3\r\n    const lines = [];\r\n    for (let i = 0; i < 9; i++) {\r\n      if (iLine[i] === 1) {\r\n        lines.push(\r\n          co.start(function* () {\r\n            yield playLine(i, iFrame[i], false, false, 4.5, 3700);\r\n\r\n          })\r\n        );\r\n      }\r\n    }\r\n    cc.find('Canvas/Game/Machine/UI/GameScore/Value').getComponent(cc.Label).string = cc.store.gameResult.WinTotalPoint;\r\n\r\n    yield co.waitForAll(lines);\r\n\r\n    // 4\r\n    if (lines.length >= 2) {\r\n      yield playVideo('random');\r\n      cc.find('Canvas/Game/Machine/Particle_coin').active=false;\r\n      cc.find('Canvas/Game/Machine/VideoFrame').active=false;\r\n      cc.audioEngine.stopAll(PublicSetUp.audio1, false);\r\n      if(PublicSetUp.sound==1){\r\n        cc.audioEngine.playMusic(PublicSetUp.MusicClip, true);\r\n      }\r\n      \r\n      \r\n    }\r\n  }\r\n  \r\n    // if(PublicSetUp.test==11){\r\n    //   freeGameNCnts[0]=1;\r\n    //   PublicSetUp.test--;\r\n    //   freeGameNCnts[1]=PublicSetUp.test;\r\n    // }else if(PublicSetUp.test<11){\r\n    //   cc.store.type=2;\r\n    //   PublicSetUp.test--;\r\n    //   freeGameNCnts[2]=PublicSetUp.test;\r\n    //   if(PublicSetUp.test==0){\r\n    //     cc.store.type=1;\r\n    //     PublicSetUp.test=12;\r\n    //   }\r\n    // }\r\n    //freeSpin\r\n    let anim = cc.find('Canvas/Game/FreeSpin').getComponent(\"freeSpinAnim\");\r\n    if(freeGameNCnts[0]==1 && cc.store.type==0){\r\n      //有中免費遊戲(第一次)\r\n      \r\n      if(cc.store.auto==false){\r\n        //如果目前不是自動\r\n        //則結束後改手動\r\n        cc.store.type=3;\r\n      }else{\r\n        cc.store.type=2;\r\n      }\r\n      \r\n      cc.store.auto=true;\r\n      anim.play();\r\n      yield co.waitForSeconds(3.1);\r\n      cc.find('Canvas/Game/Machine/UI/FreeSpinsPanel/cnt').getComponent(cc.Label).string=freeGameNCnts[1];\r\n      \r\n    }\r\n    if(cc.store.type==2){\r\n      //如果目前是免費遊戲\r\n      cc.find('Canvas/Game/Machine/UI/FreeSpinsPanel/cnt').getComponent(cc.Label).string=freeGameNCnts[2];\r\n      let _total =addFloat(PublicSetUp.freeSpinTotal,cc.store.gameResult.WinTotalPoint);    \r\n      PublicSetUp.freeSpinTotal=_total;\r\n      cc.find('Canvas/Game/Machine/UI/FreeSpinsPanel/total').getComponent(cc.Label).string=PublicSetUp.freeSpinTotal;\r\n    }\r\n    \r\n    if(cc.store.type==1){\r\n      //最後一次\r\n      cc.store.type=0;\r\n      cc.find('Canvas/Game/Machine/UI/FreeSpinsPanel/total').getComponent(cc.Label).string=cc.store.FreeTotalPoint;\r\n      yield co.waitForSeconds(1.2);     \r\n      anim.UIOff();\r\n      PublicSetUp.freeSpinTotal=0\r\n      if(cc.store.type==3){\r\n        cc.store.auto=false;\r\n      }\r\n    }\r\n\r\n\r\n\r\n  cc.find('Canvas/Game/Machine/UI/GameScore/Value').getComponent(cc.Label).string = 0;\r\n\r\n  // update user points\r\n  cc.find('Canvas/Game/Machine/UI/GamePoint/Value').getComponent(cc.Label).string = cc.store.userPoints;\r\n}\r\n"]}