{"version":3,"sources":["assets\\scripts\\BaseCmdLogic.js"],"names":["require","Observable","Photon","PhotonController","PublicSetUp","BaseCmdLogic","observable","MainSrvCmdLogic","pi","_pi","_lbSrvObj","_account","_password","prototype","RunLogin","account","password","type","_type","InitCallbackFunction","PeerStatusCallback","ResponseCallback","EventCallback","connect","SetLbSrvCmdLogicObj","lbSrvCmdLogicObj","st","selfObj","PhotonPeer","StatusCodes","sendData","vals","console","log","cc","find","active","getComponent","Label","string","ConnectToServer","GetPI","LobbySrvCmdLogic","gameid","versioncode","_gameid","_versioncode","_loginId","_loginKey","_gameSrvObj","_protocolType","loginId","loginKey","protocolType","ip","port","PhotonIf","ConnectionProtocol","Ws","Wss","SetGameSrvCmdLogicObj","gameSrvCmdLogicObj","GameSrvBaseCmdLogic","GameObj","_GameCmdFuncObj","_GameObj","SetGameCmdFunc","FuncObj","module","exports"],"mappings":"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EAAmB;AAChE,WAAKH,eAAL,GAAuBG,OAAvB;AAED,KAHD,CAzEqC,CA8ErC;;;AACAL,IAAAA,mBAAmB,CAACjD,SAApB,CAA8B4B,KAA9B,GAAsC,YAAY;AAChD,aAAO,KAAKhC,GAAZ;AACD,KAFD;;AAIA,WAAOqD,mBAAP;AACD,GApFyB,EAA1B,CA5PuB,CAgVjB;;;AACNzD,EAAAA,YAAY,CAACyD,mBAAb,GAAmCA,mBAAnC;AACD,CAlVD,EAkVGzD,YAAY,KAAKA,YAAY,GAAG,EAApB,CAlVf,GAkVyC;;;AAEzC+D,MAAM,CAACC,OAAP,GAAiBhE,YAAjB;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourceRoot":"/","sourcesContent":["const { Observable } = require('./observable.cc');\nconst Photon = require('./Photon-Javascript_SDK');\nconst PhotonController = require('./Photon_Interface');\nlet PublicSetUp=require('PublicSetUp');\n/**\n@namespace BaseCmdLogic\n處理登入、入局等底層訊息用\n*/\n// prevent globals renaming by closure compilier\nvar BaseCmdLogic;\n\n(function (BaseCmdLogic) {\n  const observable = Observable();\n  /** \n    * \n    @class MainSrvCmdLogic\n    */\n  var MainSrvCmdLogic = (function () {\n    /** \n        @constructor\n        @param {PhotonController.PhotonIf} pi photon interface\n        */\n    function MainSrvCmdLogic(pi) {\n      this._pi = pi;\n      this._lbSrvObj = null;\n      this._account = '';\n      this._password = '';\n    } //constructor function end\n\n    //login\n    MainSrvCmdLogic.prototype.RunLogin = function (account, password,type) {\n      this._account = account;\n      this._password = password;\n      this._type = type;\n      this._pi.InitCallbackFunction(this, this.PeerStatusCallback, this.ResponseCallback, this.EventCallback);\n      this._pi.connect(); //對main server做連線\n    };\n\n    //set lobby server command logic\n    MainSrvCmdLogic.prototype.SetLbSrvCmdLogicObj = function (lbSrvCmdLogicObj) {\n      this._lbSrvObj = lbSrvCmdLogicObj;\n    };\n\n    //photon peer status callback function\n    MainSrvCmdLogic.prototype.PeerStatusCallback = function (st, selfObj) {\n      switch (st) {\n        case Photon.PhotonPeer.StatusCodes.connect: //已經連上 main server\n          selfObj._pi.sendData(101, selfObj._account, selfObj._password, selfObj._type, 0, '', 999); //送出帳密\n          break;\n      }\n    };\n\n    //photon peer reponse callback function\n    MainSrvCmdLogic.prototype.ResponseCallback = function (vals, selfObj) {\n      switch (vals[0]) {\n        case 101: //server端登入回傳訊息\n          if (vals[1] == 1) {\n            //成功\n            //直接等server通知 lobby server 資訊再做連線\n\n          } else {\n\n            switch (\n              vals[1] //（0：失敗, 2：版本錯誤, 3：維護中, 4:重複登入, 5:之前遊戲局尚未結束 6：沒有進行遊戲的權限（洽客服））\n            ) {\n              case 0:\n                console.log('登入Main Srv失敗');\n                break;\n              case 2:\n                console.log('登入Main Srv版本錯誤');\n                break;\n              case 3:\n                console.log('Main Srv維護中');\n                break;\n              case 4:\n                console.log('Main Srv重複登入');\n                break;\n              case 5:\n                console.log('之前遊戲局尚未結束');\n                break;\n              case 6:\n                console.log('沒有進行遊戲的權限');\n                break;\n            }\n\n            cc.find('Canvas/LoginMessage/gohome').active = true;\n            cc.find('Canvas/LoginMessage/text').getComponent(cc.Label).string=\"登入失敗\";\n          }\n          break;\n      }\n      //console.log(\"ms response:\"+vals);\n    };\n\n    //photon peer event callback function\n    MainSrvCmdLogic.prototype.EventCallback = function (vals, selfObj) {\n      switch (vals[0]) {\n        case 102: //由 main server通知的 lobby server 資訊\n          //vals[1]:loginID\n          //vals[2]:loginKey\n          //vals[3]:protocol(0:Unknown 1:Udp 2:Tcp 3:WebSocket 4:Http 5:SecureWebSocket)\n          //vals[4]:ip\n          //vals[5]:port\n          selfObj._lbSrvObj.ConnectToServer(vals[1], vals[2], vals[3], vals[4], vals[5]);\n          break;\n      }\n      //console.log(\"ms event:\"+evt);\n    };\n    MainSrvCmdLogic.prototype.GetPI = function () {\n      return this._pi;\n    };\n    return MainSrvCmdLogic;\n  })(); //class end\n  BaseCmdLogic.MainSrvCmdLogic = MainSrvCmdLogic;\n\n  /** \n    * \n    @class LobbySrvCmdLogic\n    */\n  var LobbySrvCmdLogic = (function () {\n    /** \n        @constructor\n        */\n    function LobbySrvCmdLogic(gameid, versioncode) {\n      this._pi = null;\n      this._gameid = gameid;\n      this._versioncode = versioncode;\n      this._loginId = 0;\n      this._loginKey = 0;\n      this._gameSrvObj = null;\n      this._protocolType = 0;\n    } //constructor function end\n\n    //connect to lobby server\n    LobbySrvCmdLogic.prototype.ConnectToServer = function (loginId, loginKey, protocolType, ip, port) {\n      this._loginId = loginId;\n      this._loginKey = loginKey;\n      this._protocolType = protocolType;\n      //目前只會有 WebSocket 或 SecureWebSocket 兩種 protocol\n      if (protocolType == 3) {\n        //WebSocket\n        this._pi = new PhotonController.PhotonIf(Photon.ConnectionProtocol.Ws, ip + ':' + port);\n      } else if (protocolType == 5) {\n        //SecureWebSocket\n        this._pi = new PhotonController.PhotonIf(Photon.ConnectionProtocol.Wss, ip + ':' + port);\n      }\n      if (this._pi != null) {\n        //設定 Photon Interface 物件的 Callback Function\n        this._pi.InitCallbackFunction(this, this.PeerStatusCallback, this.ResponseCallback, this.EventCallback);\n        this._pi.connect();\n      }\n    };\n\n    //set game server command logic\n    LobbySrvCmdLogic.prototype.SetGameSrvCmdLogicObj = function (gameSrvCmdLogicObj) {\n      this._gameSrvObj = gameSrvCmdLogicObj;\n    };\n\n    //photon peer status callback function\n    LobbySrvCmdLogic.prototype.PeerStatusCallback = function (st, selfObj) {\n      switch (st) {\n        case Photon.PhotonPeer.StatusCodes.connect: //已經連上 lobby server\n          selfObj._pi.sendData(101, selfObj._loginId, selfObj._loginKey); //送出login id 與 key\n          break;\n      }\n    };\n\n    //photon peer reponse callback function\n    LobbySrvCmdLogic.prototype.ResponseCallback = function (vals, selfObj) {\n      switch (vals[0]) {\n        case 102: //登入狀態回覆\n          if (vals[1] == 1) {\n            ////狀態代碼（0：失敗, 1：成功, 2：版本錯誤, 3：維護中）\n            //加入遊戲局（this._gameid）\n            selfObj._pi.sendData(103, selfObj._gameid, -1, -1, selfObj._versioncode);\n\n          } else {\n            switch (vals[1]) {\n              case 0:\n                console.log('登入LB Srv 失敗');\n                break;\n              case 2:\n                console.log('登入LB Srv版本錯誤');\n                break;\n              case 3:\n                console.log('LB Srv 維護中');\n                break;\n            }\n\n          }\n          break;\n\n        case 103: //server送回的game server連線資訊\n          //vals[1]:loginID\n          //vals[2]:loginKey\n          //vals[3]:ip\n          //vals[4]:port\n          //vals[5]:result\n          if (vals[5] == 1) {\n            selfObj._gameSrvObj.ConnectToServer(vals[1], vals[2], selfObj._protocolType, vals[3], vals[4]);\n\n          } else {\n            switch (\n              vals[5] //0：錯誤 1：成功 2:遊戲維護中 3:版本錯誤\n            ) {\n              case 0:\n                console.log('加入game server遊戲局錯誤');\n                break;\n              case 2:\n                console.log('Game Srv 遊戲維護中');\n                break;\n              case 3:\n                console.log('要求加入Game Srv 版本錯誤');\n                break;\n            }\n\n          }\n          break;\n\n        case 104: //加入game server遊戲局結果回覆(因為可能會被game server強制斷線，所以由lobby server進行回覆)\n          if (vals[1] != 1) {\n            //-1：建立房間失敗 0：錯誤 1:成功 2：點數不足 3：沒有進行遊戲的權限（洽客服） ], 4：無可用房間, 5：此玩家之前遊戲局未結束\n            switch (vals[1]) {\n              case -1:\n                console.log('建立房間失敗');\n                break;\n              case 0:\n                console.log('加入遊戲錯誤');\n                break;\n              case 2:\n                console.log('點數不足');\n                break;\n              case 3:\n                console.log('沒有進行遊戲的權限');\n                break;\n              case 4:\n                console.log('無可用房間');\n                break;\n              case 5:\n                console.log('此玩家之前遊戲局未結束');\n                break;\n            }\n\n          }\n          break;\n      }\n      //console.log('ls response, cmd:' + vals[0]);\n    };\n\n    //photon peer event callback function\n    LobbySrvCmdLogic.prototype.EventCallback = function (vals, selfObj) {\n      console.log('ls event, cmd:' + vals[0]);\n    };\n    LobbySrvCmdLogic.prototype.GetPI = function () {\n      return this._pi;\n    };\n    return LobbySrvCmdLogic;\n  })(); //class end\n  BaseCmdLogic.LobbySrvCmdLogic = LobbySrvCmdLogic;\n\n  /** \n    * \n    @class GameSrvBaseCmdLogic\n    */\n  var GameSrvBaseCmdLogic = (function () {\n    /** \n        @constructor\n        */\n    function GameSrvBaseCmdLogic(GameObj) {\n      this._pi = null;\n      this._GameCmdFuncObj = null;\n      this._loginId = 0;\n      this._loginKey = 0;\n      this._GameObj = GameObj;\n    } //constructor function end\n\n    //connect to game server\n    GameSrvBaseCmdLogic.prototype.ConnectToServer = function (loginId, loginKey, protocolType, ip, port) {\n      //console.log('connect to gs loginId:' + loginId + ', loginKey:' + loginKey + ', protocolType:' + protocolType + ', ip:' + ip + ', port:' + port);\n      this._loginId = loginId;\n      this._loginKey = loginKey;\n      //目前只會有 WebSocket 或 SecureWebSocket 兩種 protocol\n      if (protocolType == 3) {\n        //WebSocket\n        this._pi = new PhotonController.PhotonIf(Photon.ConnectionProtocol.Ws, ip + ':' + port);\n      } else if (protocolType == 5) {\n        //SecureWebSocket\n        this._pi = new PhotonController.PhotonIf(Photon.ConnectionProtocol.Wss, ip + ':' + port);\n      }\n      if (this._pi != null) {\n        //設定 Photon Interface 物件的 Callback Function\n        this._pi.InitCallbackFunction(this, this.PeerStatusCallback, this.ResponseCallback, this.EventCallback);\n        this._pi.connect();\n      }\n    };\n\n    //photon peer status callback function\n    GameSrvBaseCmdLogic.prototype.PeerStatusCallback = function (st, selfObj) {\n      switch (st) {\n        case Photon.PhotonPeer.StatusCodes.connect: //已經連上 game server\n          selfObj._pi.sendData(101, selfObj._loginId, selfObj._loginKey); //送出login id 與 key\n          break;\n      }\n    };\n\n    //photon peer reponse callback function\n    GameSrvBaseCmdLogic.prototype.ResponseCallback = function (vals, selfObj) {\n      if(vals[0]!=3075){\n        console.log('gs response, cmd:'+vals[0]+\"--%o\",vals);\n      }\n      \n      switch (vals[0]) {\n        case 111: //收到game遊戲局已經準備完成的訊息（只會有一次）\n          selfObj._pi.sendData(3161); //送出3161，取得本桌的資訊(通知server前端遊戲已經準備就緒)\n          //押注為3162\n          break;\n\n        // case 3072: //　回傳本桌的資訊\n        //   break;\n\n        // case 3073: //　回傳押注結果資訊\n        //   break;\n\n        // case 3074: //　通知遊戲端免費遊戲結束\n        //   break;\n\n        default:\n          selfObj._GameCmdFuncObj(vals, selfObj._pi, selfObj._GameObj);\n          break;\n      }\n    };\n    //photon peer event callback function\n    GameSrvBaseCmdLogic.prototype.EventCallback = function (vals, selfObj) {\n      console.log('gs event, cmd:' + vals[0]);\n    };\n\n    //set game cmd function\n    GameSrvBaseCmdLogic.prototype.SetGameCmdFunc = function (FuncObj) {\n      this._GameCmdFuncObj = FuncObj;\n      \n    };\n\n    //Get Photon Interface object\n    GameSrvBaseCmdLogic.prototype.GetPI = function () {\n      return this._pi;\n    };\n\n    return GameSrvBaseCmdLogic;\n  })(); //class end\n  BaseCmdLogic.GameSrvBaseCmdLogic = GameSrvBaseCmdLogic;\n})(BaseCmdLogic || (BaseCmdLogic = {})); //namespace end\n\nmodule.exports = BaseCmdLogic;\n\n/*\n    //優先處理底層server event，未處理的封包會透過 default 傳給外部物件\n    PhotonIf.prototype.BaseEventCallback = function(vals, outObj){\n        console.log(\"BaseEventCallback\");\n        switch(vals[0]){\n            case 102:\n                break;\n            default:\n                this._outEventCallback(vals, outObj);\n                break;\n        }\n    }\n\n    //處理 main server的封包訊息\n    PhotonIf.prototype.ProcMainSrvResponse = function(vals, outObj){\n        console.log(\"ProcMainSrvResponse, cmd id:\"+vals[0]);\n        switch(vals[0]){\n            case 101:\n                //console.log(\"vals 1:\"+vals[1]);\n                break;\n            default:\n                this._outRspCallback(vals, outObj);\n                break;\n        }\n    };\n\n    //處理 lobby server的封包訊息\n    PhotonIf.prototype.ProcLobbySrvResponse = function(vals, outObj){\n        console.log(\"ProcLobbySrvResponse, cmd id:\"+vals[0]);\n        switch(vals[0]){\n            case 101:\n                //console.log(\"vals 1:\"+vals[1]);\n                break;\n            default:\n                this._outRspCallback(vals, outObj);\n                break;\n        }\n    };\n\n    //處理 game server的封包訊息\n    PhotonIf.prototype.ProcGameSrvResponse = function(vals, outObj){\n        console.log(\"ProcGameSrvResponse, cmd id:\"+vals[0]);\n        switch(vals[0]){\n            case 101:\n                //console.log(\"vals 1:\"+vals[1]);\n                break;\n            default:\n                this._outRspCallback(vals, outObj);\n                break;\n        }\n    };\n*/\n"]}