{"version":3,"sources":["assets\\scripts\\playVideo.js"],"names":["PublicSetUp","require","playVideo","videoPlayerNode","videoBundle","playing","onDone","player","enabled","clip","cc","find","active","name","index","on","play","audioEngine","playEffect","audio","sound","assetManager","getBundle","list","Math","floor","random","length","String","get","VideoClip","done","load","error","asset","co","waitUntil","getComponent","VideoPlayer"],"mappings":"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","sourceRoot":"/","sourcesContent":["import co from './co.cc';\nlet PublicSetUp=require('PublicSetUp');\nconst playVideo = (function () {\n  let videoPlayerNode = null;\n  let videoBundle = null;\n  let playing = false;\n\n  function onDone(player) {\n    player.enabled = false;\n    player.clip = null;\n    playing = false;\n    cc.find('Canvas/Game/Machine/VideoFrame').active=false;\n    cc.find('Canvas/Game/Machine/Particle_coin').active=false;\n  }\n\n  return function* playVideo(name,index) {\n    if (videoPlayerNode === null) {\n      videoPlayerNode = cc.find('Canvas/Game/Machine/Performance/VideoPlayer');\n      if (videoPlayerNode === null) {\n        return;\n      }\n\n      videoPlayerNode.on('ready-to-play', player => {\n        player.enabled = true;\n        player.play();\n        cc.audioEngine.playEffect(PublicSetUp.audio[\"0014\"], false);\n        if (index === 0 || index === 6 || index === 7){\n          if(PublicSetUp.sound==1){\n            \n            cc.audioEngine.playEffect(PublicSetUp.audio[\"0021\"], false);\n            \n          }\n          cc.find('Canvas/Game/Machine/Particle_coin').active=true;\n        }\n        if(name!='JACKPOT'){\n          cc.find('Canvas/Game/Machine/VideoFrame').active=true;\n        }else{\n          if(PublicSetUp.sound==1){\n            \n            cc.audioEngine.playEffect(PublicSetUp.audio[\"0021\"], false);\n            \n          }\n        }\n        \n      });\n\n      videoPlayerNode.on('error', onDone);\n\n      videoPlayerNode.on('completed', onDone);\n    }\n\n    if (videoBundle == null) {\n      videoBundle = cc.assetManager.getBundle('mp4');\n      if (videoBundle === null) {\n        return;\n      }\n    }\n\n    if (name === 'random') {\n      const list = ['LINE_MOVIE_1643105946757', 'LINE_MOVIE_1643288149416','LINE_MOVIE_1643288159743'];\n      name = list[Math.floor(Math.random() * list.length)];\n    }else if(name === 'index'){\n\n      name = String(index);\n    }else if(name=='card'){\n      name = 'JACKPOT';\n    }\n\n    let clip = videoBundle.get(name, cc.VideoClip);\n    if (clip == null) {\n      let done = false;\n      videoBundle.load(name, cc.VideoClip, (error, asset) => {\n        done = true;\n        if (!error) {\n          clip = asset;\n          // clip.addRef();\n        }\n      });\n\n      yield co.waitUntil(() => done === true);\n    }\n\n    if (clip != null) {\n      videoPlayerNode.getComponent(cc.VideoPlayer).clip = clip;\n      playing = true;\n      yield co.waitUntil(() => playing === false);\n    }\n  };\n})();\n\nexport default playVideo;\n"]}